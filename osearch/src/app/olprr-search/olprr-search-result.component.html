<mat-card>
    <mat-card-content>
        <div class="incident">
            <div class="loading-indicator" *ngIf="dataSource.loading$ | async">
                <mat-progress-spinner mode="indeterminate" color="primary"></mat-progress-spinner>
            </div>
            <div class="form-group row fielddefaultbackground">  
                <div class="col-sm-10 col-md-10 col-lg-10"></div>
                <div *ngIf="totalRows > 0">
                    <div class="col-sm-2 col-md-2 col-lg-2"> 
                        <button mat-raised-button color="primary" type="button" class="btn btn-success btn-md btn-block btn-block-auto-width" (click)="genExcel()" >{{exportToCsv}}</button>       
                    </div>
                </div>
            </div>
            <div class="responsive-table">
                <mat-table class="child-table" cdkScrollable [dataSource]="dataSource"
                            matSort  matSortActive="olprrId" matSortDirection="asc" matSortDisableClear >

                    <ng-container matColumnDef="reqPageNumber" >
                        <mat-header-cell *matHeaderCellDef>Action</mat-header-cell>
                        <mat-cell *matCellDef="let olprrSearchResultStats"> 
                            <button mat-raised-button color="primary" type="button" (click)="onRowClicked(olprrSearchResultStats.olprrId)" >Select</button>  
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="olprrId">
                        <mat-header-cell *matHeaderCellDef mat-sort-header >OlprrId</mat-header-cell>
                        <mat-cell *matCellDef="let olprrSearchResultStats">{{olprrSearchResultStats.olprrId}}</mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="siteStatus">
                        <mat-header-cell *matHeaderCellDef  mat-sort-header >Status</mat-header-cell>
                        <mat-cell *matCellDef="let olprrSearchResultStats">{{olprrSearchResultStats.siteStatus}}</mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="releaseType">
                        <mat-header-cell *matHeaderCellDef mat-sort-header >Release Type</mat-header-cell>
                        <mat-cell *matCellDef="let olprrSearchResultStats">{{olprrSearchResultStats.releaseTypeName}}</mat-cell>
                    </ng-container>
                            
                    <ng-container matColumnDef="receiveDate">
                        <mat-header-cell *matHeaderCellDef  mat-sort-header >Received Date</mat-header-cell>
                        <mat-cell *matCellDef="let olprrSearchResultStats">{{olprrSearchResultStats.receiveDate | date:'MM/dd/yyyy'}}</mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="siteName">
                        <mat-header-cell *matHeaderCellDef  mat-sort-header >Site Name</mat-header-cell>
                        <mat-cell *matCellDef="let olprrSearchResultStats">{{olprrSearchResultStats.siteName}}</mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="siteAddress">
                        <mat-header-cell *matHeaderCellDef  mat-sort-header >Site Address</mat-header-cell>
                        <mat-cell *matCellDef="let olprrSearchResultStats">{{olprrSearchResultStats.siteAddress}}</mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="siteCounty">
                        <mat-header-cell *matHeaderCellDef>Site County</mat-header-cell>
                        <mat-cell *matCellDef="let olprrSearchResultStats">{{olprrSearchResultStats.countyName}}</mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="reportedBy">
                        <mat-header-cell *matHeaderCellDef  mat-sort-header >Reported By</mat-header-cell>
                        <mat-cell *matCellDef="let olprrSearchResultStats">{{olprrSearchResultStats.reportedBy}}</mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="siteComment">
                        <mat-header-cell *matHeaderCellDef  >Site Comment</mat-header-cell>
                        <mat-cell *matCellDef="let olprrSearchResultStats">{{olprrSearchResultStats.siteComment}}</mat-cell>
                    </ng-container>

                    <mat-header-row *matHeaderRowDef="displayedColumns" color="primary"></mat-header-row>

                    <mat-row *matRowDef="let row; columns: displayedColumns" (click)="onRowClicked(row.olprrId)"></mat-row>

                </mat-table>
            </div>

            <mat-paginator [length]="totalRows" [pageSize]="40"
            [pageSizeOptions]="[30, 40, 50, 100]" ></mat-paginator>

        </div>
    </mat-card-content>
</mat-card>